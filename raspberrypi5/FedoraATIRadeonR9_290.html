<!doctype html>
<html>
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <meta name="generator" content="pandoc">
      <meta name="author" content="Bas Magré">
      <meta name="date" content="2025-11-09">
      
      <title>Raspberry Pi 5 - Fedora with AMDGPU, play Halflife
2</title>
      <link rel="icon" href="/website-template/favicon.ico">
      <!-- Bootstrap -->
      <link rel="stylesheet" target="_blank" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
      <!-- Font-awesome -->
      <link rel="stylesheet" target="_blank" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <!-- Styles -->
      <link rel="stylesheet" href="/website-template/styles.css">
            <!-- Add favicon here -->
            <!-- Add site-verifications here -->
         </head>
   <body>
            <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
                <!--<a class="navbar-brand" href="#">Navbar</a>-->
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                   <ul class="navbar-nav mr-auto">
                      <li class="nav-item active">
                         <a class="nav-link" href="/index.html">Me <span class="sr-only">(current)</span></a>
                      </li>
                      <!-- <li class="nav-item">
                         <a class="nav-link" href="#">Link</a>
                      </li> -->
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarKODI" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Kodi Addons
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarKODI">
                           <a class="dropdown-item" href="/kodi/npo.html">NPO Uitzending gemist</a>               
                           <a class="dropdown-item" href="/kodi/kanalenlijst-hans.html">De Transponder - Kanalenlijk (Hans)</a>
                           <div class="dropdown-divider"></div>
                           <a class="dropdown-item" href="/kodi/rtlxl.html">(Inactive) RTLxl</a>
                        </div>
                     </li>
                     <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarPi5" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Raspberry Pi 5
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarPi5">
                           <a class="dropdown-item" href="/raspberrypi5/FedoraATIRadeonR9_290.html">Fedora with AMDGPU playing Half Life 2</a>
                        </div>
                     </li>
                     <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarMilkVJ" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Milk-V Jupiter
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarMilkVJ">
                           <a class="dropdown-item" href="/milkVjupiter/OpenSUSEATIRadeonR9_290.html">ATI Radeon R9 290 Kernel 6.1</a>
                           <a class="dropdown-item" href="/milkVjupiter/OpenSUSEATIRadeonHD5850.html">OpenSUSE Tumbleweed ATI Radeon HD 5850 Kernel 6.6</a>
                        </div>
                     </li>
                      <li class="nav-item dropdown">
                         <a class="nav-link dropdown-toggle" href="#" id="navbarSFVF2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                         Starfive VisionFive 2
                         </a>
                         <div class="dropdown-menu" aria-labelledby="navbarSFVF2">
                            <a class="dropdown-item" href="/starfiveVisionFive2/UbuntuATIRadeonR9_290.html">Ubuntu 22.04 with ATI Radeon R9 290</a>
                            <a class="dropdown-item" href="/starfiveVisionFive2/FedoraATIRadeon5450.html">Fedora with ATI Radeon5450</a>
                            <a class="dropdown-item" href="/starfiveVisionFive2/UbuntuATIRadeonR9_290_2023_11_20.html">Ubuntu 23.10 with ATI Radeon R9 290</a>
                            <a class="dropdown-item" href="/starfiveVisionFive2/OpenSUSEATIRadeonR9_290.html">OpenSUSE Tumbleweed ATI Radeon R9 290</a>
                            <a class="dropdown-item" href="/starfiveVisionFive2/OpenSUSEATIRadeonR9_290_mainline.html">OpenSUSE Tumbleweed ATI Radeon R9 290 mainline kernel</a>
                            <a class="dropdown-item" href="/starfiveVisionFive2/Ubuntu2410_outofthebox.html">StarFive VisionFive 2 Ubuntu 24.10 AMDGPU</a>
                            <a class="dropdown-item" href="/starfiveVisionFive2/Ubuntu2504_outofthebox.html">StarFive VisionFive 2 Ubuntu 25.04 AMDGPU</a>
                            <!-- <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#">Something else here</a> -->
                         </div>
                      </li>
                      <!-- <li class="nav-item">
                         <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
                      </li> -->
                   </ul>
                   <div class="menu-icons">
                     <a class="menu-icon" target="_blank" href="https://github.com/Opvolger" target="_blank"><i class="fa fa-github fa-2x"></i></a>
                     <a class="menu-icon" target="_blank" href="https://www.twitter.com/Opvolger" target="_blank"><i class="fa fa-twitter fa-2x"></i></a>
                     <a class="menu-icon" href="mailto:Opvolger@gmail.com"><i class="fa fa-at fa-2x"></i></a>
                     <a class="menu-icon" target="_blank" href="https://www.linkedin.com/in/bas-magr%C3%A9-67234222/" target="_blank"><i class="fa fa-linkedin fa-2x"></i></a>
                     <a class="menu-icon" target="_blank" href="https://www.youtube.com/@justanotherdevopsguy" target="_blank"><i class="fa fa-youtube fa-2x"></i></a>
                     <a class="menu-icon" target="_blank" href="https://www.youtube.com/@opvolger" target="_blank"><i class="fa fa-youtube fa-2x"></i></a>
                  </div>

                   <!-- <form class="form-inline my-2 my-lg-0">
                      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                      <button class="btn btn-outline-info my-2 my-sm-0" type="submit">Search</button>
                   </form> -->
                </div>
             </nav>
            <div class="container">
         <p class="date">2025-11-09 - Bas Magré</p>
         <!-- <h1 class="title">Raspberry Pi 5 - Fedora with AMDGPU,
play Halflife 2</h1> -->
                  <div class="row">
            <div class="col-xl-10"><h1
id="rpi-5---fedora-with-amdgpu-and-halflife-2">RPi 5 - Fedora with
AMDGPU and Halflife 2</h1>
<p>With an external GPU, you can build your own kernel and boot Fedora
aarch64 Desktop.</p>
<h2 id="fallback-to-llvmpipe-on-radeon-drivers">Fallback to llvmpipe on
Radeon drivers</h2>
<p>Al my ATI Radeon didn’t work (I had screen output), but all did
fallback to llvmpipe. So no hardware acceleration.</p>
<p>But the ATI Radeon R9 290 has Radeon and AMDGPU support in the
kernel. If you don’t build or disable Radeon in the kernel arguments,
the AMDGPU drivers will work!</p>
<h2 id="flash-the-fedora-kde-desktop-to-sd-card">Flash the Fedora KDE
Desktop to SD-card</h2>
<p>I downloaded the <a
target="_blank" href="https://download.fedoraproject.org/pub/fedora/linux/releases/43/KDE/aarch64/images/Fedora-KDE-Desktop-Disk-43-1.6.aarch64.raw.xz">Fedora-KDE-Desktop-Disk-43-1.6.aarch64.raw.xz</a>
from the <a
target="_blank" href="https://fedoraproject.org/kde/download">website</a>.</p>
<p>Flashed it to a SD-card with <code>Fedora Media Writer</code>. (Use
options <code>Select .iso file</code>)</p>
<p>After the SD-card was flashed, i opened <code>gparted</code> and
deleted the first 2 partitions. Created a new fat32 one and added the
label <code>bootfs</code> and added the Flag <code>lba</code> to it.</p>
<p>Next I Resized the fedora partition to the end of the disk.</p>
<p>This will give something like this:</p>
<figure>
<img src="FedoraATIRadeonR9_290/gparted.png" alt="img" />
<figcaption aria-hidden="true">img</figcaption>
</figure>
<h2 id="build-the-kernel">Build the kernel</h2>
<p>Compiling will be done on an amd64 desktop. So we will
cross-compile.</p>
<p>I have installed Fedora Linux and had to install some stuff to be
able to cross compile</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo dnf group install <span class="st">&quot;Development Tools&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo dnf install git gcc-plugin-devel libmpc-devel gcc-c++ gcc-c++-aarch64-linux-gnu ncurses-devel libmpc-devel nano gparted</span></code></pre></div>
<p>I will work from the directory <code>/home/opvolger/demo</code>.</p>
<h3 id="check-out-firmwares">Check out firmwares</h3>
<p>First we need to clone the linux firmware</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd /home/opvolger/demo</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> git clone <span class="at">--depth</span> 1 git://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git</span></code></pre></div>
<p>We need this, so we can add firmware directly in the kernel.</p>
<h3 id="build-kernel">Build kernel</h3>
<p>Now we can clone the raspberry pi kernel.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checkout kernel code</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd /home/opvolger/demo</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> git clone <span class="at">--branch</span> rpi-6.12.y <span class="at">--depth</span> 1 https://github.com/raspberrypi/linux.git raspberrypi-6.12-y</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd raspberrypi-6.12-y</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we want to cross-compile the kernel</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> export ARCH=arm64</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> export CROSS_COMPILE=aarch64-linux-gnu-</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># make a default .config for the pi5 chip.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> make bcm2712_defconfig</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to make (and add stuff) changes</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> make menuconfig</span></code></pre></div>
<p>Select the next kernel options</p>
<pre><code>Device Drivers
└─&gt;Generic Driver Options
    └─&gt;Firmware loader
      () Build named firmware blobs into the kernel binary
      (../linux-firmware) Firmware blobs root directory</code></pre>
<p>In the
<code>Build named firmware blobs into the kernel binary</code>, you will
need to add your blobs of your AMD video card. In my case it was the
hawaii (R2 290) blobs. For example the 200-series you can find you
“blob-names: on <a
target="_blank" href="https://en.wikipedia.org/wiki/Radeon_200_series">wikipedia</a></p>
<p>If you do not have the correct blobs, you can see it with the
commands following after booting:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> journalctl <span class="at">-b</span> <span class="kw">|</span> <span class="fu">grep</span> radeon</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> journalctl <span class="at">-b</span> <span class="kw">|</span> <span class="fu">grep</span> amdgpu</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> journalctl <span class="at">-b</span> <span class="kw">|</span> <span class="fu">grep</span> firmware</span></code></pre></div>
<p>Than you can change it and rebuild the kernel.</p>
<p>Change Firmware blobs root directory to
<code>../linux-firmware</code></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">amdgpu/hawaii_k_smc.bin amdgpu/hawaii_smc.bin amdgpu/hawaii_uvd.bin amdgpu/hawaii_vce.bin amdgpu/hawaii_sdma.bin amdgpu/hawaii_sdma1.bin amdgpu/hawaii_pfp.bin amdgpu/hawaii_me.bin amdgpu/hawaii_ce.bin amdgpu/hawaii_rlc.bin amdgpu/hawaii_mec.bin amdgpu/hawaii_mc.bin radeon/hawaii_pfp.bin radeon/hawaii_me.bin radeon/hawaii_ce.bin radeon/hawaii_mec.bin radeon/hawaii_mc.bin radeon/hawaii_rlc.bin radeon/hawaii_sdma.bin radeon/hawaii_smc.bin radeon/hawaii_k_smc.bin radeon/HAWAII_pfp.bin radeon/HAWAII_me.bin radeon/HAWAII_ce.bin radeon/HAWAII_mec.bin radeon/HAWAII_mc.bin radeon/HAWAII_mc2.bin radeon/HAWAII_rlc.bin radeon/HAWAII_sdma.bin radeon/HAWAII_smc.bin</span></span></code></pre></div>
<p>Add AMDGPU/ATIGPU support</p>
<pre><code>Linux Kernel Configuration
└─&gt;Device Drivers
  └─&gt;Graphics support
    └─&gt;Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)
      &lt;*&gt; ATI Redeon
      &lt;*&gt; AMD GPU
      [*]   Enable amdgpu support for SI parts (NEW)
      [*]   Enable amdgpu support for CIK parts (NEW)</code></pre>
<p>Change
<code>Direct Rendering Manager (XFree86 4.1.0 and higher DRI support)</code>
from <code>M</code> (Modules) to <code>*</code> (with in the kernel)
(with the space bar).</p>
<p>I disabled all <code>DRM support ....</code> that where selected. and
selected <code>ATI Redeon</code>, <code>AMD GPU</code> and enabled SI en
CIK support.</p>
<p>Now we want sound on the HDMI monitor, so we add support for
that.</p>
<pre><code>Device Drivers
└─&gt;Sound card support
  └─&gt;Advanced Linux Sound Architecture
    └─&gt;HD-Audio
        &lt;*&gt; HD Audio PCI
        &lt;*&gt; Build HDMI/DisplayPort HD-audio codec support</code></pre>
<p>Change <code>Advanced Linux Sound Architecture</code> from
<code>M</code> (Modules) to <code>*</code> (with in the kernel) (with
the space bar).</p>
<p>Select <code>*</code> for <code>HD Audio PCI</code> and now you can
select <code>*</code> by
<code>Build HDMI/DisplayPort HD-audio codec support</code>.</p>
<p>Now add and change the file systems we will support</p>
<pre><code>File systems
└─&gt;&lt;*&gt; Btrfs filesystem support
   [*] Btrfs POSIX Access Control Lists
   [*] Btrfs debugging support
   [*] Btrfs assert support
   [*] Btrfs with the ref verify tool compiled in</code></pre>
<p>I changed all the <code>M</code> (Modules) to <code>*</code> (with in
the kernel) (if possible) (with the space bar) and added all the Btrfs
options. No idea if i need them all….</p>
<p>Change <code>M</code> to <code>*</code> from ZRAM and enable all the
sub <code>Compressed RAM block device support</code>:</p>
<pre><code>Device Drivers
└─&gt;Block devices
    └─&gt;&lt;*&gt;Compressed RAM block device support
       [*]     lz4 compression support
        [*]     lz4hc compression support 
        [*]     zstd compression support  
        [*]     deflate compression support
        [*]     842 compression support
        [*]     lzo and lzo-rle compression support
                Default zram compressor (zstd)  ---&gt;
        [*]     Write back incompressible or idle page to backing device
        [*]     Track access time of zram entries
        [*]     Track zRam block status
        [*]     Enable multiple compression streams</code></pre>
<p>We now need to set the page size from 16 to 4 in the kernel</p>
<pre><code>Kernel Features
└─&gt;Page size (16KB)</code></pre>
<p>Now you need to select <code>4KB</code> (space bar).</p>
<p>We can now Exit and save the changes!</p>
<p>You can disable more options (Like
<code>Amateur Radio support</code>, <code>Industrial I/O support</code>,
<code>USB sound devices</code> ,<code>ALSA for SoC audio support</code>,
<code>Broadcom VideoCore support</code>, <code>Touchscreens</code>,
<code>Media USB Adapters</code>, <code>Radio Adapters</code> and
<code>Support for small TFT LCD display modules</code>), but this is
optional. The kernel will compile faster.</p>
<p>Before we can build, we need to add a kernel patch. We need to change
code so the pi can work with the AMDGPU.</p>
<p>Create a file <code>drm.patch</code> in
<code>/home/opvolger/demo/raspberrypi-6.12-y/</code>. I found this patch
<a
target="_blank" href="https://github.com/geerlingguy/raspberry-pi-pcie-devices/discussions/756">here</a>.</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode patch"><code class="sourceCode diff"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>From c1d421d7c501c77e8c04bdfa141a55e639822c03 Mon Sep 17 00:00:00 2001</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>From: Yang Bo &lt;bo.yang@smail.nju.edu.cn&gt;</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>Date: Wed, 28 May 2025 11:18:19 +0800</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Subject: [PATCH] Add amdgpu support for arm SoC</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>Change-Id: Ic95c8514271d246dd668631810e8dee210f7f1b4</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>Signed-off-by: Yanghaku &lt;bo.yang@smail.nju.edu.cn&gt;</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="kw">---</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a> drivers/gpu/drm/ttm/ttm_bo_util.c | 14 +-------------</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a> drivers/gpu/drm/ttm/ttm_module.c  |  5 +++++</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a> 2 files changed, 6 insertions(+), 13 deletions(-)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="kw">diff --git a/drivers/gpu/drm/ttm/ttm_bo_util.c b/drivers/gpu/drm/ttm/ttm_bo_util.c</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>index 0b3f4267130c..e0e55cb9edd2 100644</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="kw">--- a/drivers/gpu/drm/ttm/ttm_bo_util.c</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="dt">+++ b/drivers/gpu/drm/ttm/ttm_bo_util.c</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -343,8 +343,6 @@ static int ttm_bo_kmap_ttm(struct ttm_buffer_object *bo,</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        .no_wait_gpu = false</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    };</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    struct ttm_tt *ttm = bo-&gt;ttm;</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="st">-   struct ttm_resource_manager *man =</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="st">-           ttm_manager_type(bo-&gt;bdev, bo-&gt;resource-&gt;mem_type);</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    pgprot_t prot;</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    int ret;</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -354,17 +352,7 @@ static int ttm_bo_kmap_ttm(struct ttm_buffer_object *bo,</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    if (ret)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        return ret;</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="st">-   if (num_pages == 1 &amp;&amp; ttm-&gt;caching == ttm_cached &amp;&amp;</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="st">-       !(man-&gt;use_tt &amp;&amp; (ttm-&gt;page_flags &amp; TTM_TT_FLAG_DECRYPTED))) {</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="st">-       /*</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="st">-        * We&#39;re mapping a single page, and the desired</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="st">-        * page protection is consistent with the bo.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="st">-        */</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="st">-       map-&gt;bo_kmap_type = ttm_bo_map_kmap;</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="st">-       map-&gt;page = ttm-&gt;pages[start_page];</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="st">-       map-&gt;virtual = kmap(map-&gt;page);</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="st">-   } else {</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="va">+   {</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>        /*</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>         * We need to use vmap to get the desired page protection</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>         * or to make the buffer object look contiguous.</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="kw">diff --git a/drivers/gpu/drm/ttm/ttm_module.c b/drivers/gpu/drm/ttm/ttm_module.c</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>index b3fffe7b5062..9f3e425626b5 100644</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a><span class="kw">--- a/drivers/gpu/drm/ttm/ttm_module.c</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="dt">+++ b/drivers/gpu/drm/ttm/ttm_module.c</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="dt">@@ -63,7 +63,12 @@ pgprot_t ttm_prot_from_caching(enum ttm_caching caching, pgprot_t tmp)</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a> {</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    /* Cached mappings need no adjustment */</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>    if (caching == ttm_cached)</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="va">+   {</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a><span class="va">+#ifdef CONFIG_ARM64</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="va">+       return pgprot_dmacoherent(tmp);</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a><span class="va">+#endif</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>        return tmp;</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a><span class="va">+   }</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a> #if defined(__i386__) || defined(__x86_64__)</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    if (caching == ttm_write_combined)</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="st">-- </span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a><span class="dt">2.49.0</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we first apply the patch</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> git apply </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># now we build the kernel. i have 16 cores, so i will build with -j 16</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> make <span class="at">-j</span> 16</span></code></pre></div>
<h2 id="copy-to-sd-card">Copy to SD-card</h2>
<p>I mounted the SD-cart to <code>/run/media/opvolger/BOOTFS/</code> and
<code>/run/media/opvolger/fedora/</code>. with dolphin (auto mount).</p>
<p>Now create the file
<code>/run/media/opvolger/BOOTFS/config.txt</code> with nano or
something else.</p>
<p>Here you can set some pi-setting for boot time</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no idea if they are all needed</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatically load overlays for detected DSI displays</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="dt">display_auto_detect</span><span class="ot">=</span><span class="dv">1</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatically load initramfs files, if found (we don&#39;t)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="dt">auto_initramfs</span><span class="ot">=</span><span class="dv">1</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Run in 64-bit mode</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="dt">arm_64bit</span><span class="ot">=</span><span class="dv">1</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Disable compensation for displays with overscan</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="dt">disable_overscan</span><span class="ot">=</span><span class="dv">1</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Run as fast as firmware / board allows</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="dt">arm_boost</span><span class="ot">=</span><span class="dv">1</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># The name of the kernel</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="dt">kernel</span><span class="ot">=</span><span class="st">Image</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># enable pci-express</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="dt">dtparam</span><span class="ot">=</span><span class="st">pciex1</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co"># enable serial (so you can see what is going wrong over serial)</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="dt">enable_serial</span><span class="ot">=</span><span class="dv">1</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="dt">enable_uart</span><span class="ot">=</span><span class="dv">1</span></span></code></pre></div>
<p>First check you PARTUUID of your fedora rootfs. You can do this with
with the command <code>blkid</code></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> blkid</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">................</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="ex">................</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="ex">................</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="ex">................</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="ex">/dev/sdb1:</span> LABEL_FATBOOT=<span class="st">&quot;BOOTFS&quot;</span> LABEL=<span class="st">&quot;BOOTFS&quot;</span> UUID=<span class="st">&quot;F830-72A5&quot;</span> BLOCK_SIZE=<span class="st">&quot;512&quot;</span> TYPE=<span class="st">&quot;vfat&quot;</span> PARTUUID=<span class="st">&quot;a5e8e31d-01&quot;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="ex">/dev/zram0:</span> LABEL=<span class="st">&quot;zram0&quot;</span> UUID=<span class="st">&quot;d3cb02f4-a70f-4f48-92ce-1bb0474c14fc&quot;</span> TYPE=<span class="st">&quot;swap&quot;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="ex">/dev/sdb3:</span> LABEL=<span class="st">&quot;fedora&quot;</span> UUID=<span class="st">&quot;fe1a5809-2964-4049-804b-c6308eea9706&quot;</span> UUID_SUB=<span class="st">&quot;8695f5be-13c2-4f38-9ec4-ca593ac9665d&quot;</span> BLOCK_SIZE=<span class="st">&quot;4096&quot;</span> TYPE=<span class="st">&quot;btrfs&quot;</span> PARTUUID=<span class="st">&quot;a5e8e31d-03&quot;</span></span></code></pre></div>
<p>Now create the file
<code>/run/media/opvolger/BOOTFS/cmdline.txt</code> with nano or
something else.</p>
<p>This will add kernel argument on boot time. We enable serial output,
set the correct settings for the root-fs of fedora, disable radeon
drivers and enable amdgpu drivers.</p>
<p>Here we can use <code>a5e8e31d-03</code> for the
<code>PARTUUID</code>. don’t forget to update. The boot process will
stop. (it will not find a root partition).</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="dt">console</span><span class="ot">=</span><span class="st">serial0,115200 console=tty1 root=PARTUUID=a5e8e31d-03 ro rootflags=subvol=root rhgb rootflags=subvol=root fsck.repair=yes rootwait plymouth.ignore-serial-consoles radeon.si_support=0 radeon.cik_support=0 amdgpu.si_support=1 amdgpu.cik_support=1</span></span></code></pre></div>
<p>Now we change the fstab file from the fedora root partition. We have
deleted the boot partition, so we must delete it from the mount on
startup.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> nano /run/media/opvolger/fedora/root/etc/fstab</span></code></pre></div>
<p>Add a <code>#</code> for the /boot and /boot/efi mounts. On a newer
version the UUID’s can be different, keep them, only add the
<code>#</code> on the lines where <code>/boot</code> annd
<code>/boot/efi</code> are located.</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="dt">UUID</span><span class="ot">=</span><span class="st">fe1a5809-2964-4049-804b-c6308eea9706 / btrfs x-systemd.growfs,compress=zstd:1,defaults,subvol=root 0 1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#UUID=c17a86dd-8323-4e0d-9595-3ba0107f6345 /boot ext4 defaults 0 0</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="dt">UUID</span><span class="ot">=</span><span class="st">fe1a5809-2964-4049-804b-c6308eea9706 /home btrfs x-systemd.growfs,compress=zstd:1,subvol=home 0 0</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="dt">UUID</span><span class="ot">=</span><span class="st">fe1a5809-2964-4049-804b-c6308eea9706 /var btrfs x-systemd.growfs,compress=zstd:1,subvol=var 0 0</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#UUID=9AB8-3989 /boot/efi vfat defaults,umask=0077,shortname=winnt 0 0</span></span></code></pre></div>
<p>Now we only have to copy the kernel files!</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd /home/opvolger/demo/raspberrypi-6.12-y</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># copy kernel and device tree to boot partition SD-card</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cp arch/arm64/boot/Image /run/media/opvolger/BOOTFS/</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cp arch/arm64/boot/dts/broadcom/bcm2712-rpi-5-b.dtb /run/media/opvolger/BOOTFS/</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># copy overlay needed for pi boot process</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> mkdir /run/media/opvolger/BOOTFS/overlays</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cp /home/opvolger/demo/raspberrypi-6.12-y/arch/arm64/boot/dts/overlays/<span class="pp">*</span> /run/media/opvolger/BOOTFS/overlays</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># now make the modules install them on the SD-card root partition (fedora)</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo ARCH=arm64 make modules_install INSTALL_MOD_PATH=/run/media/opvolger/fedora/</span></code></pre></div>
<h2 id="boot-from-sd-card">Boot from SD-Card</h2>
<p>Umount the root and boot partitions from the SD-card.</p>
<p>If everything works great, you will see a setup and can create a
user.</p>
<h3 id="install-stream">Install Stream</h3>
<p>We need to install fex (intel/amd64 emulator), it needs it own
root-fs. We will make one for him.</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sudo dnf install fex-emu fex-emu-filesystem fex-emu-rootfs-fedora fex-emu-thunks fex-emu-utils erofs-fuse  erofs-utils  squashfuse  squashfuse-libs patchelf</span></code></pre></div>
<p>Now run <code>FEXRootFSFetcher</code> to create a intel/amd64
root-fs. I had the most success with Ubuntu 24.04.</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> FEXRootFSFetcher</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="ex">RootFS</span> not found. Do you want to try and download one<span class="pp">?</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Response</span> <span class="dt">{y</span><span class="op">,</span><span class="dt">yes</span><span class="op">,</span><span class="dt">1}</span> or <span class="dt">{n</span><span class="op">,</span><span class="dt">no</span><span class="op">,</span><span class="dt">0}</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> y</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="ex">RootFS</span> list selection</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="ex">Options:</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="ex">0:</span> Cancel</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="ex">1:</span> Fedora 40 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="ex">2:</span> Fedora 40 <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="ex">3:</span> Fedora 38 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        <span class="ex">4:</span> Fedora 38 <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="ex">5:</span> ArchLinux <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="ex">6:</span> ArchLinux <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="ex">7:</span> Ubuntu 24.04 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="ex">8:</span> Ubuntu 24.04 <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        <span class="ex">9:</span> Ubuntu 23.10 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        <span class="ex">10:</span> Ubuntu 23.10 <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        <span class="ex">11:</span> Ubuntu 23.04 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        <span class="ex">12:</span> Ubuntu 23.04 <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        <span class="ex">13:</span> Ubuntu 22.10 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        <span class="ex">14:</span> Ubuntu 22.10 <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        <span class="ex">15:</span> Ubuntu 22.04 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        <span class="ex">16:</span> Ubuntu 22.04 <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        <span class="ex">17:</span> Ubuntu 20.04 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        <span class="ex">18:</span> Ubuntu 20.04 <span class="er">(</span><span class="ex">SquashFS</span><span class="kw">)</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="ex">Response</span> {1-18} or 0 to cancel</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> 7</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="ex">Selected</span> Rootfs: Ubuntu 24.04 <span class="er">(</span><span class="ex">EroFS</span><span class="kw">)</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>        <span class="ex">URL:</span> https://rootfs.fex-emu.gg/Ubuntu_24_04/2025-03-04/Ubuntu_24_04.ero</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="ex">Are</span> you sure that you want to download this image</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="ex">Response</span> <span class="dt">{y</span><span class="op">,</span><span class="dt">yes</span><span class="op">,</span><span class="dt">1}</span> or <span class="dt">{n</span><span class="op">,</span><span class="dt">no</span><span class="op">,</span><span class="dt">0}</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> y</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  <span class="ex">%</span> Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>                                 <span class="ex">Dload</span>  Upload   Total   Spent    Left  Speed</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="ex">100</span> 1393M  100 1393M    0     0  34.0M      0  0:00:40  0:00:40 <span class="at">--:--:--</span> 33.4M</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="ex">Do</span> you wish to extract the erofs file or use it as-is<span class="pp">?</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="ex">Options:</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>        <span class="ex">0:</span> Cancel</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>        <span class="ex">1:</span> Extract</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>        <span class="ex">2:</span> As-Is</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="ex">Response</span> {1-2} or 0 to cancel</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> 1</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="ex">Extracting</span> Erofs. This might take a few minutes.</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="ex">Do</span> you wish to set this RootFS as default<span class="pp">?</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="ex">Response</span> <span class="dt">{y</span><span class="op">,</span><span class="dt">yes</span><span class="op">,</span><span class="dt">1}</span> or <span class="dt">{n</span><span class="op">,</span><span class="dt">no</span><span class="op">,</span><span class="dt">0}</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> y</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="ex">Ubuntu_24_04</span> set as default RootFS</span></code></pre></div>
<p>We now have a root-fs for intel/amd64 (games). But we need to install
steam and dependacies, so we can game!</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here is the intel/amd64 root-fs located</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd ~/.fex-emu/RootFS/Ubuntu_24_04/</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get into the root-fs (so we can install steam on the root-fs)</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> python chroot.py chroot</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Creating</span> FEX paths</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Copying</span> FEXInterpreter depends</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Patching</span> FEX dependencies</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Mounting</span> rootfs paths</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Setting</span> up FEXServer config</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Chrooting</span> in to /home/opvolger/.fex-emu/RootFS/Ubuntu_24_04</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="ex">root@raspberrypi:/#</span> apt update</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="ex">Get:73</span> http://archive.ubuntu.com/ubuntu noble-backports/main amd64 Components [7144 B]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="ex">Get:74</span> http://archive.ubuntu.com/ubuntu noble-backports/universe i386 Packages [15.8 kB]</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="ex">Get:75</span> http://archive.ubuntu.com/ubuntu noble-backports/universe amd64 Packages [28.9 kB]</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="ex">Get:76</span> http://archive.ubuntu.com/ubuntu noble-backports/universe Translation-en [17.5 kB]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="ex">Get:77</span> http://archive.ubuntu.com/ubuntu noble-backports/universe amd64 Components [11.0 kB]</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="ex">Get:78</span> http://archive.ubuntu.com/ubuntu noble-backports/restricted amd64 Components [212 B]</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="ex">Get:79</span> http://archive.ubuntu.com/ubuntu noble-backports/multiverse amd64 Components [212 B]</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="ex">Fetched</span> 76.5 MB in 20s <span class="er">(</span><span class="ex">3846</span> kB/s<span class="kw">)</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="ex">Reading</span> package lists... Done</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="ex">Building</span> dependency tree... Done</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="ex">Reading</span> state information... Done</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="ex">189</span> packages can be upgraded. Run <span class="st">&#39;apt list --upgradable&#39;</span> to see them.</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="ex">root@raspberrypi:/#</span> apt install steam</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="ex">Recommended</span> packages:</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="ex">luit</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="ex">The</span> following NEW packages will be installed:</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>  <span class="ex">bubblewrap</span> cpp cpp-13 cpp-13-x86-64-linux-gnu cpp-x86-64-linux-gnu file fuse3 gcc-13-base libauthen-sasl-perl</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libclone-perl</span> libdata-dump-perl libencode-locale-perl libfile-basedir-perl libfile-desktopentry-perl</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libfile-listing-perl</span> libfile-mimeinfo-perl libfont-afm-perl libfuse3-3 libhtml-form-perl libhtml-format-perl</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libhtml-parser-perl</span> libhtml-tagset-perl libhtml-tree-perl libhttp-cookies-perl libhttp-daemon-perl</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libhttp-date-perl</span> libhttp-message-perl libhttp-negotiate-perl libio-html-perl libio-socket-ssl-perl</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libio-stringy-perl</span> libipc-system-simple-perl libisl23 liblwp-mediatypes-perl liblwp-protocol-https-perl</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libmagic-mgc</span> libmagic1t64 libmailtools-perl libmpc3 libmpfr6 libnet-dbus-perl libnet-http-perl libnet-smtp-ssl-perl</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libnet-ssleay-perl</span> libnm0 libnm0:i386 libpipewire-0.3-0t64 libpipewire-0.3-common libspa-0.2-modules</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libtext-iconv-perl</span> libtie-ixhash-perl libtimedate-perl libtry-tiny-perl liburi-perl libva-glx2 libva-glx2:i386</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libwww-perl</span> libwww-robotrules-perl libx11-protocol-perl libxkbfile1 libxml-parser-perl libxml-twig-perl</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  <span class="ex">libxml-xpathengine-perl</span> libxmuu1 libxxf86dga1 perl-openssl-defaults steam:i386 steam-devices steam-installer</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  <span class="ex">steam-libs</span> steam-libs:i386 steam-libs-i386:i386 x11-utils x11-xserver-utils xdg-desktop-portal</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  <span class="ex">xdg-desktop-portal-gtk</span> xdg-utils</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="ex">0</span> upgraded, 77 newly installed, 0 to remove and 189 not upgraded.</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="ex">Need</span> to get 17.8 MB of archives.</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="ex">After</span> this operation, 63.1 MB of additional disk space will be used.</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a><span class="ex">Do</span> you want to continue<span class="pp">?</span> <span class="pp">[</span><span class="ss">Y/n</span><span class="pp">]</span> Y</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a><span class="ex">.....</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up libmailtools-perl <span class="er">(</span><span class="ex">2.21-2</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up libhttp-daemon-perl <span class="er">(</span><span class="ex">6.16-1</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up cpp <span class="er">(</span><span class="ex">4:13.2.0-7ubuntu1</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up xdg-desktop-portal-gtk <span class="er">(</span><span class="ex">1.15.1-1build2</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up x11-xserver-utils <span class="er">(</span><span class="ex">7.7+10build2</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up liblwp-protocol-https-perl <span class="er">(</span><span class="ex">6.13-1</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up libwww-perl <span class="er">(</span><span class="ex">6.76-1</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up libxml-parser-perl <span class="er">(</span><span class="ex">2.47-1build3</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up libxml-twig-perl <span class="er">(</span><span class="ex">1:3.52-2</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a><span class="ex">Setting</span> up libnet-dbus-perl <span class="er">(</span><span class="ex">1.2.0-2build3</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a><span class="ex">Processing</span> triggers for hicolor-icon-theme <span class="er">(</span><span class="ex">0.17-2</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a><span class="ex">Processing</span> triggers for libc-bin <span class="er">(</span><span class="ex">2.39-0ubuntu8.4</span><span class="kw">)</span> <span class="ex">...</span></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a><span class="ex">root@raspberrypi:/#</span></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a><span class="bu">exit</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Returning</span> from chroot</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Deleting</span> FEX paths</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Unmount</span> rootfs paths</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a><span class="ex">[sudo]</span> password for opvolger:</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a><span class="ex">INFO:root:Fixing</span> any potential permission issues</span></code></pre></div>
<p>We now have installed steam on the root-fs on the emulator. Now we
need to install steam on the system. This can be done with the <a
target="_blank" href="https://raw.githubusercontent.com/ptitSeb/box64/refs/heads/main/install_steam.sh">script
from box64</a></p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd ~/</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> wget https://raw.githubusercontent.com/ptitSeb/box64/refs/heads/main/install_steam.sh</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> chmod +x install_steam.sh</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ./install_steam.sh</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># run steam!</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> FEXBatch</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="ex">FEXBash-opvolger@raspberrypi:~</span><span class="op">&gt;</span> steam</span></code></pre></div>
<p>This can give an error of missing packages… just hit Enter and
continue.</p>
<p>This script will install Steam in your home dir. After the setup is
finished you can start Steam just with the command <code>FEXBatch</code>
and than <code>steam</code>. ignore all the errors you see in your
screen…. Steam client will start!</p>
<p>Download <code>Half Life 2</code>. Start your game!</p></div>
            <div class="d-none d-xl-block col-xl-2 bd-toc">
               <ul class="section-nav">
                  <li class="toc-entry"><ul>
<li><a href="#rpi-5---fedora-with-amdgpu-and-halflife-2"
id="toc-rpi-5---fedora-with-amdgpu-and-halflife-2">RPi 5 - Fedora with
AMDGPU and Halflife 2</a>
<ul>
<li><a href="#fallback-to-llvmpipe-on-radeon-drivers"
id="toc-fallback-to-llvmpipe-on-radeon-drivers">Fallback to llvmpipe on
Radeon drivers</a></li>
<li><a href="#flash-the-fedora-kde-desktop-to-sd-card"
id="toc-flash-the-fedora-kde-desktop-to-sd-card">Flash the Fedora KDE
Desktop to SD-card</a></li>
<li><a href="#build-the-kernel" id="toc-build-the-kernel">Build the
kernel</a></li>
<li><a href="#copy-to-sd-card" id="toc-copy-to-sd-card">Copy to
SD-card</a></li>
<li><a href="#boot-from-sd-card" id="toc-boot-from-sd-card">Boot from
SD-Card</a></li>
</ul></li>
</ul></li>
               </ul>
            </div>
         </div>
               </div>
            <!-- Add comment hosting service here -->
            <!-- Footer -->
            <footer class="footer text-muted">
                <div align="center">
                   <!-- Update licences -->
                   Content is available under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener">CC BY-SA 3.0</a>
                   &nbsp;|&nbsp;
                   Sourcecode licensed under <a target="_blank" href="https://www.gnu.org/licenses/gpl-3.0.en.html" target="_blank" rel="noopener">GPL-3.0</a>
                   <br />
                   <!-- Please keep the following line -->
                   Built with <a target="_blank" href="https://www.pandoc.org" target="_blank" rel="noopener">Pandoc</a> 
                   using <a target="_blank" href="https://github.com/ashki23/pandoc-bootstrap" target="_blank" rel="noopener">pandoc-bootstrap</a> theme
                   <br />
                   <!-- Update copyright -->
                   Copyright, Bas Magr&eacute;
                </div>
             </footer>
             <!-- Add global site tag (gtag.js) and site analytics here -->
            <!-- JS, Popper.js, and jQuery -->
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
      <!-- Mathjax -->
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script>
         /* Bootstrap styles to tables */
         function bootstrapStylePandocTables() {
         $('tr.header').parent('thead').parent('table').addClass('table table-condensed'); }
         $(document).ready(function () { bootstrapStylePandocTables(); });
         /* Adjust the height when click the toc */
         var shiftWindow = function() { scrollBy(0, -60) };
         window.addEventListener("hashchange", shiftWindow);
         function load() { if (window.location.hash) shiftWindow(); }
      </script>
   </body>
</html>